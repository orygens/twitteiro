jQuery(function(f){var e=f("meta[name=csrf-token]").attr("content"),g=f("meta[name=csrf-param]").attr("content");f.fn.extend({triggerAndReturn:function(h,j){var i=new f.Event(h);this.trigger(i,j);return i.result!==false},callRemote:function(){var j=this,l=j.attr("method")||j.attr("data-method")||"GET",i=j.attr("action")||j.attr("href"),h=j.attr("data-type")||"script";if(i===undefined){throw"No URL specified for remote call (action or href must be present)."}else{if(j.triggerAndReturn("ajax:before")){var k=j.is("form")?j.serializeArray():[];f.ajax({url:i,data:k,dataType:h,type:l.toUpperCase(),beforeSend:function(m){j.trigger("ajax:loading",m)},success:function(n,m,o){j.trigger("ajax:success",[n,m,o])},complete:function(m){j.trigger("ajax:complete",m)},error:function(o,m,n){j.trigger("ajax:failure",[o,m,n])}})}j.trigger("ajax:after")}}});f("a[data-confirm],input[data-confirm]").live("click",function(){var h=f(this);if(h.triggerAndReturn("confirm")){if(!confirm(h.attr("data-confirm"))){return false}}});f("form[data-remote]").live("submit",function(h){f(this).callRemote();h.preventDefault()});f("a[data-remote],input[data-remote]").live("click",function(h){f(this).callRemote();h.preventDefault()});f("a[data-method]:not([data-remote])").live("click",function(l){var k=f(this),i=k.attr("href"),m=k.attr("data-method"),j=f('<form method="post" action="'+i+'"></form>'),h='<input name="_method" value="'+m+'" type="hidden" />';if(g!=null&&e!=null){h+='<input name="'+g+'" value="'+e+'" type="hidden" />'}j.hide().append(h).appendTo("body");l.preventDefault();j.submit()});var c="input[data-disable-with]";var d="form[data-remote]:has("+c+")";var b="form:not([data-remote]):has("+c+")";var a=function(){f(this).find(c).each(function(){var h=f(this);h.data("enable-with",h.val()).attr("value",h.attr("data-disable-with")).attr("disabled","disabled")})};f(d).live("ajax:before",a);f(b).live("submit",a);f(d).live("ajax:complete",function(){f(this).find(c).each(function(){var h=f(this);h.removeAttr("disabled").val(h.data("enable-with"))})})});